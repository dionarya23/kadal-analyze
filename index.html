<!DOCTYPE html>
<html>
<head>
    <title>Kadal Analyze</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <!-- Bootstrap core CSS -->
    <link rel="icon" href="http://jinja.apsara.org/blog/djinjok_transparent.gif" sizes="32x32 48x48" type="image/vnd.microsoft.icon">
    <link href="https://blackrockdigital.github.io/startbootstrap-creative/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="https://blackrockdigital.github.io/startbootstrap-creative/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <!-- Plugin CSS -->
    <link href="https://blackrockdigital.github.io/startbootstrap-creative/vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>

</head>
<body>

<script type="text/javascript">
var gambarnya;
    function processImage() {

      if(document.getElementById('file').value != '' && $('#url_gambar').val() !== ''){
        swal('Maaf', 'Dua Dua Nya Tidak Boleh terisi', 'error');
      }else if(document.getElementById('file').value === '' && $('#url_gambar').val() === ''){
          swal('Maaf', 'Anda Harus Menyediakan gambar pilih salah satu', 'error');
      }else{

        var subscriptionKey = "cd64e4065a6d42d8b42efdcff9dced94";
        var uriBase = "https://westcentralus.api.cognitive.microsoft.com/vision/v1.0/analyze";
        var params = {
            "visualFeatures": "Categories,Description,Color",
            "details": "",
            "language": "en",
        };

        $('#loading').fadeIn();
        $('#pertama').fadeOut();
        $.ajax({
            url: uriBase + "?" + $.param(params),
            beforeSend: function(xhrObj){
                xhrObj.setRequestHeader("Content-Type","application/json");
                xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key", subscriptionKey);
            },

            type: "POST",
            data: '{"url": ' + '"' + gambarnya + '"}',
        })

        .done(function(data) {
          $('#loading').fadeOut();
          $('#result-image').fadeIn();
          var hasil;
          var hasil2 = null;
          data.description.tags.forEach(e => {

            if(e === 'lizard'){
              hasil2 = "Itu Gambar Kadal";
            }else{
              hasil = "Itu Bukan Gambar kadal";
            }

          });

          if(hasil2!== null){
            $('#hasilnya').html(hasil2);
        }else{
            $('#hasilnya').html(hasil);
          }

          $('#gambar_hasil').attr('src', gambarnya);

        })
        .fail(function(jqXHR, textStatus, errorThrown) {
            var errorString = (errorThrown === "") ? "Error. " : errorThrown + " (" + jqXHR.status + "): ";
            errorString += (jqXHR.responseText === "") ? "" : jQuery.parseJSON(jqXHR.responseText).message;
            swal('Sorry', errorString, 'error');
            $('#loading').fadeOut('hilang');
            $('#pertama').fadeIn('hilang');
        });
      }
    };

    $(document).ready(function(){

      function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
               gambarnya = e.target.result;
           }
           console.log(input.files);
            reader.readAsDataURL(input.files[0]);
            console.log(reader.readAsDataURL(input.files[0]));
        }
    }

      $('#file').change(function(){
        $('#url_gambar').attr('disabled', 'disabled');
        readURL(this);
      });

      $('#url_gambar').keyup(function(){
        if($('#url_gambar').val() != ''){
          $('#file').attr('disabled', 'disabled');
          gambarnya = $('#url_gambar').val();
        }else{
          $('#file').removeAttr('disabled');
        }
      });
    });
</script>

<body id="page-top">

  <header class="masthead text-center text-white d-flex">
    <div class="container">
      <div class="row">
        <div class="col-lg-10 mx-auto">
          <h1 class="text-uppercase" style="margin-top:20px">
            <strong>Kadal Analyze</strong>
            <p>By Dion Arya Pamungkas</p>
          </h1>
          <hr>
        </div>
        <div class="col-lg-8 mx-auto">
          <p class="text-faded mb-5">Contoh Penggunaan Microsoft Azure (Computer Vision)
            website ini bisa membedakan antara gambar kadal dan bukan gambar kadal</p>

            <div id="loading" class="hilang">
            <div class="spinner">
              <div class="rect1"></div>
              <div class="rect2"></div>
              <div class="rect3"></div>
              <div class="rect4"></div>
              <div class="rect5"></div></div>
          </div>

          <div id="result-image" class="hilang" style="margin: 0 auto;">
          <div class="thumbnail">
            <img id="gambar_hasil" class="img-rounded" width="320" height="320">
            <div class="caption">
              <p style="padding:5px;background-color:red" id="hasilnya"></p>
            </div>
          </div>
        </div>


<div id="pertama">
            <div class="form-group">
              <label>Contoh: https://statik.tempo.co/data/2017/11/16/id_663183/663183_720.jpg</label>
              <input type="text" id="url_gambar" placeholder="Letakan Url Gambar Disini" class="form-control">
            </div>

<div class="hilang">
            <h5>Atau</h5>
            <div class="form-group">
              <input type="file" class="form-control" id="file">
            </div>
            <br>
          </div>

          <button class="btn btn-primary btn-xl js-scroll-trigger" onclick="processImage()" href="#about">Mulai</button>
</div>

        </div>
      </div>
    </div>
  </header>



</body>

</html>


</body>
</html>
